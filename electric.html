<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ê¸°ì°¨ ìŠ¤ë§ˆíŠ¸ ê³„ì‚°ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .header {
            background: #1e293b;
            color: white;
            padding: 32px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            padding: 40px;
        }

        .section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #475569;
        }

        .required::after {
            content: " *";
            color: #ef4444;
        }

        .input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* ì°¨ëŸ‰ ì„ íƒ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .vehicle-selection {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }

        .vehicle-tabs {
            display: flex;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .vehicle-tab {
            flex: 1;
            padding: 12px 16px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: #64748b;
            transition: all 0.2s;
        }

        .vehicle-tab.active {
            background: white;
            color: #1e293b;
            border-bottom: 2px solid #3b82f6;
        }

        .vehicle-tab-content {
            padding: 16px;
            background: white;
        }

        .vehicle-tab-panel {
            display: none;
        }

        .vehicle-tab-panel.active {
            display: block;
        }

        .vehicle-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
        }

        .vehicle-item {
            padding: 14px 16px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .vehicle-item:hover {
            background: #f8fafc;
        }

        .vehicle-item:last-child {
            border-bottom: none;
        }

        .vehicle-item.selected {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
        }

        .vehicle-item.no-selection {
            background: #f1f5f9;
            border-left: 4px solid #64748b;
            font-weight: 500;
        }

        .vehicle-item.no-selection:hover {
            background: #e2e8f0;
        }

        .vehicle-name {
            font-weight: 500;
            color: #1e293b;
            font-size: 0.95rem;
            line-height: 1.4;
            flex: 1;
        }

        .vehicle-subsidy {
            font-size: 0.85rem;
            font-weight: 500;
            min-width: 120px;
            text-align: right;
        }

        .subsidy-high {
            color: #059669;
        }

        .subsidy-medium {
            color: #d97706;
        }

        .subsidy-low {
            color: #dc2626;
        }

        .subsidy-none {
            color: #64748b;
        }

        /* ê°€ê²© ì…ë ¥ ë²„íŠ¼ */
        .price-input-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .price-input {
            flex: 1;
            text-align: right;
        }

        .price-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .price-btn {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: #f9fafb;
            color: #374151;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .price-btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .calculate-btn {
            width: 100%;
            padding: 16px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .calculate-btn:hover {
            background: #2563eb;
        }

        .calculate-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        /* ê²°ê³¼ ì„¹ì…˜ */
        .result-section {
            background: #ffffff;
            padding: 40px;
            border-radius: 16px;
            margin-top: 32px;
            display: none;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .result-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin-bottom: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .result-item {
            background: #f8fafc;
            padding: 24px 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }

        .result-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .result-item.subsidy {
            background: linear-gradient(135deg, #f0fdf4 0%, #f7fee7 100%);
            border-color: #bbf7d0;
        }

        .result-item.tax {
            background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
            border-color: #fecaca;
        }

        .result-item.reduction {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
            border-color: #d8b4fe;
        }

        .result-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #1e293b;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .result-value.positive {
            color: #059669;
        }

        .result-value.negative {
            color: #dc2626;
        }

        .result-icon {
            font-size: 1.1rem;
        }

        /* ì§€ë¶ˆê¸ˆì•¡ ìš”ì•½ ì„¹ì…˜ */
        .payment-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            align-items: start;
        }

        .calculation-breakdown {
            background: #f8fafc;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .calculation-breakdown h4 {
            color: #1e293b;
            margin-bottom: 16px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-size: 0.95rem;
        }

        .breakdown-label {
            color: #475569;
            font-weight: 500;
        }

        .breakdown-value {
            color: #1e293b;
            font-weight: 600;
        }

        .breakdown-add .breakdown-label {
            color: #dc2626;
        }

        .breakdown-subtract .breakdown-label {
            color: #059669;
        }

        .breakdown-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 12px 0;
        }

        .breakdown-result {
            border-top: 2px solid #3b82f6;
            padding-top: 12px !important;
            margin-top: 8px;
        }

        .breakdown-result .breakdown-label {
            color: #1e293b;
            font-weight: 700;
            font-size: 1rem;
        }

        .breakdown-result .breakdown-value {
            color: #3b82f6;
            font-weight: 800;
            font-size: 1.1rem;
        }

        .final-result {
            background: linear-gradient(135deg, #1e293b 0%, #475569 100%);
            color: white;
            padding: 32px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(30, 41, 59, 0.2);
            height: fit-content;
        }

        .final-label {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 16px;
            font-weight: 500;
        }

        .final-value {
            font-size: 2.2rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        /* ì •ë³´ ë°•ìŠ¤ */
        .info-box-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 16px 0;
        }

        .info-box {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 16px;
        }

        .info-box h4 {
            color: #0369a1;
            margin-bottom: 8px;
            font-size: 0.925rem;
        }

        .info-box ul {
            margin-left: 16px;
            color: #0c4a6e;
            font-size: 0.875rem;
        }

        .info-box ul li {
            margin-bottom: 4px;
        }

        /* í•˜ë‹¨ ì•ˆë‚´ */
        .footer-info {
            background: #f1f5f9;
            padding: 24px;
            margin-top: 32px;
            border-radius: 8px;
            border-top: 3px solid #3b82f6;
        }

        .footer-info h4 {
            color: #1e293b;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .footer-info p {
            color: #475569;
            font-size: 0.875rem;
            margin-bottom: 8px;
        }

        .footer-info a {
            color: #3b82f6;
            text-decoration: none;
        }

        .footer-info a:hover {
            text-decoration: underline;
        }

        /* ì—ëŸ¬ ë©”ì‹œì§€ */
        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 12px 16px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.875rem;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 8px;
            }

            .main-content {
                padding: 24px;
            }

            .header {
                padding: 24px;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .price-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .result-grid {
                grid-template-columns: 1fr;
            }

            .payment-summary {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .vehicle-tabs {
                flex-direction: column;
            }

            .info-box-container {
                grid-template-columns: 1fr;
            }

            .vehicle-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }

            .vehicle-subsidy {
                text-align: left;
                min-width: auto;
            }

            .final-value {
                font-size: 1.8rem;
            }

            .breakdown-item {
                font-size: 0.875rem;
            }
        }

        .custom-input-section {
            margin-top: 16px;
        }

        .custom-input-row {
            display: grid;
            grid-template-columns: 1fr 100px;
            gap: 12px;
            align-items: end;
        }

        .select-vehicle-btn {
            padding: 8px 12px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .select-vehicle-btn:hover {
            background: #2563eb;
        }

        .flex-1 {
            flex: 1;
        }

        /* ê´‘ê³  ì»¨í…Œì´ë„ˆ */
        .ad-container {
            margin: 32px 0;
            text-align: center;
        }

        .ad-placeholder {
            background: #f8fafc;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            padding: 40px 20px;
            color: #64748b;
            font-size: 0.875rem;
        }

        .ad-placeholder p {
            margin: 0 0 4px 0;
            font-weight: 500;
        }

        .ad-placeholder span {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        /* í•˜ë‹¨ í‘¸í„° */
        .footer {
            background: #1e293b;
            color: white;
            margin-top: 0;
        }

        .footer-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 32px 40px;
            text-align: center;
        }

        .footer-content p {
            margin: 0 0 8px 0;
            opacity: 0.9;
        }

        .footer-content p:first-child {
            font-weight: 500;
            font-size: 1rem;
        }

        .footer-content p:last-of-type {
            font-size: 0.875rem;
            opacity: 0.7;
            margin-bottom: 16px;
        }

        .footer-links {
            font-size: 0.875rem;
        }

        .footer-links a {
            color: #94a3b8;
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-links span {
            margin: 0 12px;
            opacity: 0.5;
        }

        /* ê²€ìƒ‰ ìë™ì™„ì„± ê°œì„  */
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #3b82f6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .suggestions-custom {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #3b82f6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 180px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }

        .suggestion-item:hover {
            background-color: #f8f9fa;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-highlight {
            background-color: #fef3c7;
            font-weight: 500;
        }

        .search-container {
            position: relative;
        }

        /* ì°¨ëŸ‰ ê²€ìƒ‰ ì¶”ê°€ */
        .vehicle-search {
            margin-bottom: 12px;
        }

        .search-input {
            position: relative;
        }

        .vehicle-count {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 8px;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš— ì „ê¸°ì°¨ ìŠ¤ë§ˆíŠ¸ ê³„ì‚°ê¸°</h1>
            <p>ì „ê¸°ì°¨ êµ¬ë§¤ ì‹œ ì·¨ë“ì„¸ì™€ ë³´ì¡°ê¸ˆì„ ê°„í¸í•˜ê²Œ ê³„ì‚°í•˜ì„¸ìš”</p>
        </div>

        <div class="main-content">
            <!-- í•„ìˆ˜ ì •ë³´ ì…ë ¥ -->
            <div class="section">
                <h2 class="section-title">ğŸ“‹ í•„ìˆ˜ ì •ë³´</h2>
                
                <div class="form-group">
                    <label class="form-label required">ì°¨ëŸ‰ ê°€ì•¡ (ë§Œì›)</label>
                    <div class="price-input-container">
                        <input type="number" id="vehiclePrice" class="input price-input" 
                               placeholder="ì°¨ëŸ‰ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”" min="0" step="1" />
                        <span>ë§Œì›</span>
                    </div>
                    <div class="price-buttons">
                        <button class="price-btn" onclick="addPrice(1000)">+ 1,000ë§Œ</button>
                        <button class="price-btn" onclick="addPrice(500)">+ 500ë§Œ</button>
                        <button class="price-btn" onclick="addPrice(100)">+ 100ë§Œ</button>
                        <button class="price-btn" onclick="addPrice(50)">+ 50ë§Œ</button>
                        <button class="price-btn" onclick="addPrice(10)">+ 10ë§Œ</button>
                        <button class="price-btn" onclick="clearPrice()">ì´ˆê¸°í™”</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label required">ì°¨ëŸ‰ ì¢…ë¥˜</label>
                    <select id="vehicleType" class="input">
                        <option value="passenger" selected>ìŠ¹ìš©ì°¨ (7%)</option>
                        <option value="van">ìŠ¹í•©ì°¨ (5%)</option>
                        <option value="truck">í™”ë¬¼ì°¨ (5%)</option>
                        <option value="commercial">ì˜ì—…ìš© ìë™ì°¨ (4%)</option>
                    </select>
                </div>
            </div>

            <!-- ì„ íƒ ì •ë³´ ì…ë ¥ -->
            <div class="section">
                <h2 class="section-title">âš™ï¸ ì„ íƒ ì •ë³´</h2>
                
                <div class="form-group">
                    <label class="form-label">ì°¨ëŸ‰ ì„ íƒ (êµ­ê³  ë³´ì¡°ê¸ˆ ìë™ ì ìš©)</label>
                    <div class="vehicle-selection">
                        <div class="vehicle-tabs">
                            <button class="vehicle-tab active" onclick="switchVehicleTab('list')">ì°¨ëŸ‰ ëª©ë¡ì—ì„œ ì„ íƒ</button>
                            <button class="vehicle-tab" onclick="switchVehicleTab('direct')">ì§ì ‘ ì…ë ¥</button>
                        </div>
                        
                        <div class="vehicle-tab-content">
                            <!-- ì°¨ëŸ‰ ëª©ë¡ íƒ­ -->
                            <div id="list-tab" class="vehicle-tab-panel active">
                                <!-- ì œì¡°ì‚¬ ì„ íƒ -->
                                <div class="manufacturer-selection" style="margin-bottom: 16px;">
                                    <label class="form-label">ì œì¡°ì‚¬ ì„ íƒ</label>
                                    <select id="manufacturerFilter" class="input" onchange="filterByManufacturer()">
                                        <option value="">ì „ì²´ ì œì¡°ì‚¬</option>
                                    </select>
                                </div>
                                
                                <div class="vehicle-count" id="vehicleCount">ì´ 0ê°œ ì°¨ëŸ‰</div>
                                <div class="vehicle-list" id="vehicleList">
                                    <!-- ì°¨ëŸ‰ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                                </div>
                            </div>
                            
                            <!-- ì§ì ‘ ì…ë ¥ íƒ­ -->
                            <div id="direct-tab" class="vehicle-tab-panel">
                                <div class="custom-input-section">
                                    <div class="search-container">
                                        <input type="text" id="customVehicleName" class="input" 
                                               placeholder="ì°¨ëŸ‰ ëª¨ë¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì•„ì´ì˜¤ë‹‰6 ë¡±ë ˆì¸ì§€)" />
                                        <div id="customVehicleSuggestions" class="suggestions-custom"></div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 8px; margin-top: 12px;">
                                        <button class="select-vehicle-btn flex-1" onclick="selectCustomVehicle()">ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ì„ íƒ</button>
                                        <button class="select-vehicle-btn" onclick="clearCustomSelection()">ì´ˆê¸°í™”</button>
                                    </div>
                                    
                                    <div style="margin-top: 16px;">
                                        <label class="form-label">êµ­ê³  ë³´ì¡°ê¸ˆ ì§ì ‘ ì…ë ¥ (ë§Œì›)</label>
                                        <input type="number" id="customSubsidy" class="input" 
                                               placeholder="ë³´ì¡°ê¸ˆ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 680)" min="0" step="1" />
                                    </div>
                                    
                                    <p style="font-size: 0.8rem; color: #64748b; margin-top: 8px;">
                                        * ì°¨ëŸ‰ëª… ì…ë ¥ í›„ ìë™ì™„ì„±ì—ì„œ ì„ íƒí•˜ê±°ë‚˜, ë³´ì¡°ê¸ˆì„ ì§ì ‘ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="selectedVehicleInfo" style="margin-top: 12px; padding: 12px; background: #f0f9ff; border-radius: 6px; display: none;">
                        <strong>ì„ íƒëœ ì°¨ëŸ‰:</strong> <span id="selectedVehicleName"></span><br>
                        <strong>êµ­ê³  ë³´ì¡°ê¸ˆ:</strong> <span id="selectedVehicleSubsidy"></span>ë§Œì›
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ì§€ì—­ ì„ íƒ (ì§€ìì²´ ë³´ì¡°ê¸ˆ)</label>
                    <select id="localSubsidy" class="input">
                        <option value="0">ì—†ìŒ</option>
                    </select>
                </div>

                <div class="info-box-container">
                    <div class="info-box">
                        <h4>ğŸ’° ë³´ì¡°ê¸ˆ ì§€ì› ê¸°ì¤€</h4>
                        <ul>
                            <li><strong>ì „ì•¡ ì§€ì›:</strong> ì°¨ëŸ‰ ê°€ì•¡ 5,300ë§Œì› ë¯¸ë§Œ</li>
                            <li><strong>50% ì§€ì›:</strong> 5,300ë§Œì› ì´ìƒ ~ 8,500ë§Œì› ë¯¸ë§Œ</li>
                            <li><strong>ë¯¸ì§€ì›:</strong> 8,500ë§Œì› ì´ìƒ</li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <h4>ğŸ·ï¸ ì·¨ë“ì„¸ ê°ë©´ í˜œíƒ</h4>
                        <ul>
                            <li><strong>ê²½ì°¨:</strong> 4% ì ìš© í›„ 75ë§Œì› ê°ë©´</li>
                            <li><strong>ì¼ë°˜ ì „ê¸°ì°¨:</strong> 2026ë…„ê¹Œì§€ 140ë§Œì›, 2027ë…„ 100ë§Œì› ê°ë©´</li>
                            <li><strong>í”ŒëŸ¬ê·¸ì¸ í•˜ì´ë¸Œë¦¬ë“œ:</strong> 40ë§Œì› ê°ë©´</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateTax()">
                ê³„ì‚°í•˜ê¸°
            </button>

            <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
            <div id="resultSection" class="result-section">
                <h3 class="result-title">
                    ğŸ“Š ê³„ì‚° ê²°ê³¼
                </h3>
                
                <div class="result-grid">
                    <div class="result-item subsidy">
                        <div class="result-label">êµ­ê³  ë³´ì¡°ê¸ˆ</div>
                        <div class="result-value positive" id="nationalSubsidy">
                            <span class="result-icon">ğŸ’°</span>0ë§Œì›
                        </div>
                    </div>
                    <div class="result-item subsidy">
                        <div class="result-label">ì§€ìì²´ ë³´ì¡°ê¸ˆ</div>
                        <div class="result-value positive" id="localSubsidyAmount">
                            <span class="result-icon">ğŸ›ï¸</span>0ë§Œì›
                        </div>
                    </div>
                    <div class="result-item subsidy">
                        <div class="result-label">ì´ ë³´ì¡°ê¸ˆ</div>
                        <div class="result-value positive" id="totalSubsidy">
                            <span class="result-icon">ğŸ’</span>0ë§Œì›
                        </div>
                    </div>
                    <div class="result-item tax">
                        <div class="result-label">ê¸°ë³¸ ì·¨ë“ì„¸</div>
                        <div class="result-value" id="baseTax">
                            <span class="result-icon">ğŸ“‹</span>0ë§Œì›
                        </div>
                    </div>
                    <div class="result-item reduction">
                        <div class="result-label">ê°ë©´ í˜œíƒ</div>
                        <div class="result-value positive" id="taxReduction">
                            <span class="result-icon">ğŸ</span>0ë§Œì›
                        </div>
                    </div>
                    <div class="result-item tax">
                        <div class="result-label">ìµœì¢… ì·¨ë“ì„¸</div>
                        <div class="result-value" id="finalTaxInGrid">
                            <span class="result-icon">ğŸ’¸</span>0ë§Œì›
                        </div>
                    </div>
                </div>

                <!-- ì´ ì§€ë¶ˆê¸ˆì•¡ê³¼ ê³„ì‚° ìš”ì•½ -->
                <div class="payment-summary">
                    <div class="calculation-breakdown">
                        <h4>ğŸ’¡ ê³„ì‚° ìš”ì•½</h4>
                        <div class="breakdown-item">
                            <span class="breakdown-label">ì°¨ëŸ‰ ê°€ê²©</span>
                            <span class="breakdown-value" id="vehiclePriceDisplay">0ë§Œì›</span>
                        </div>
                        <div class="breakdown-item breakdown-add">
                            <span class="breakdown-label">+ ìµœì¢… ì·¨ë“ì„¸</span>
                            <span class="breakdown-value" id="finalTaxDisplay">0ë§Œì›</span>
                        </div>
                        <div class="breakdown-item breakdown-subtract">
                            <span class="breakdown-label">- ì´ ë³´ì¡°ê¸ˆ</span>
                            <span class="breakdown-value" id="totalSubsidyDisplay">0ë§Œì›</span>
                        </div>
                        <div class="breakdown-divider"></div>
                        <div class="breakdown-item breakdown-result">
                            <span class="breakdown-label">ì‹¤ì œ ì§€ë¶ˆ ê¸ˆì•¡</span>
                            <span class="breakdown-value" id="totalPaymentBreakdown">0ë§Œì›</span>
                        </div>
                    </div>
                    
                    <div class="final-result">
                        <div class="final-label">ì´ ì°¨ëŸ‰ ì§€ë¶ˆ ê¸ˆì•¡</div>
                        <div class="final-value" id="totalPayment">
                            <span>ğŸ¦</span>0ë§Œì›
                        </div>
                    </div>
                </div>
            </div>

            <!-- í•˜ë‹¨ ì•ˆë‚´ ì •ë³´ -->
            <div class="footer-info">
                <h4>ğŸ“Œ ë” ìì„¸í•œ ì •ë³´ í™•ì¸</h4>
                <p><strong>ì •í™•í•œ ë³´ì¡°ê¸ˆ í™•ì¸:</strong> <a href="https://www.ev.or.kr/nportal/buySupprt/initBuySubsidySupprtAction.do" target="_blank">ì „ê¸°ì°¨ ëˆ„ë¦¬ì§‘</a></p>
                <p>â€¢ êµ­ê³  ë³´ì¡°ê¸ˆ: êµ¬ë§¤ ë° ì§€ì› â†’ êµ¬ë§¤ë³´ì¡°ê¸ˆ ì§€ì› â†’ êµ­ê³  ë³´ì¡°ê¸ˆ</p>
                <p>â€¢ ì§€ìì²´ ë³´ì¡°ê¸ˆ: êµ¬ë§¤ ë° ì§€ì› â†’ êµ¬ë§¤ë³´ì¡°ê¸ˆ ì§€ì› â†’ ì§€ìì²´ ë³´ì¡°ê¸ˆ</p>
                <p>â€¢ êµ¬ë§¤ë³´ì¡°ê¸ˆ ì§€ê¸‰í˜„í™©: êµ¬ë§¤ ë° ì§€ì› â†’ êµ¬ë§¤ë³´ì¡°ê¸ˆ ì§€ê¸‰í˜„í™©</p>
                <p style="margin-top: 12px; font-size: 0.8rem; color: #64748b;">
                    * ë³¸ ê³„ì‚°ê¸°ëŠ” ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì„¸ì•¡ì€ ê´€í•  ì„¸ë¬´ì„œë‚˜ ì „ë¬¸ê¸°ê´€ì— ë¬¸ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
                </p>
                <p style="font-size: 0.8rem; color: #64748b;">
                    * ì°¨ëŸ‰ ë°ì´í„°ëŠ” 2025ë…„ 7ì›” 11ì¼ ê¸°ì¤€ì´ë©°, ìµœì‹  ì •ë³´ëŠ” ì „ê¸°ì°¨ ëˆ„ë¦¬ì§‘ì—ì„œ í™•ì¸í•˜ì„¸ìš”.
                </p>
            </div>

            <!-- ê´‘ê³  ê³µê°„ (êµ¬ê¸€ ì• ë“œì„¼ìŠ¤) -->
            <div class="ad-container">
                <div class="ad-placeholder">
                    <p>ê´‘ê³ </p>
                    <span>Google AdSense</span>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ì¹´í”¼ë¼ì´íŠ¸ -->
        <div class="footer">
            <div class="footer-content">
                <p>ì „ê¸°ì°¨ ìŠ¤ë§ˆíŠ¸ ê³„ì‚°ê¸°</p>
                <p>&copy; 2025 All rights reserved.</p>
                <div class="footer-links">
                    <a href="#" onclick="showPrivacyPolicy()">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
                    <span>|</span>
                    <a href="#" onclick="showTerms()">ì´ìš©ì•½ê´€</a>
                    <span>|</span>
                    <a href="mailto:contact@ev-calculator.com">ë¬¸ì˜í•˜ê¸°</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let nationalSubsidyData = [];
        let localSubsidyData = [];
        let selectedVehicle = null;
        let currentTab = 'list';
        let filteredVehicles = [];

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('í˜ì´ì§€ ë¡œë“œ ì‹œì‘...');
            loadCompleteData();
            populateLocalSubsidyOptions();
            populateManufacturerOptions();
            setupCustomVehicleSearch();
            
            // ì•½ê°„ì˜ ì§€ì—° í›„ ì°¨ëŸ‰ ëª©ë¡ ìƒì„± (DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„)
            setTimeout(() => {
                populateVehicleList();
                console.log('ì´ˆê¸°í™” ì™„ë£Œ');
            }, 100);
        });

        // ì°¨ëŸ‰ ê²€ìƒ‰ ê¸°ëŠ¥ ì„¤ì •
        function setupVehicleSearch() {
            const searchInput = document.getElementById('vehicleSearch');
            const suggestions = document.getElementById('vehicleSearchSuggestions');

            if (!searchInput || !suggestions) return;

            searchInput.addEventListener('input', function() {
                const query = this.value.trim();
                filterByManufacturer(); // ì œì¡°ì‚¬ í•„í„°ì™€ í•¨ê»˜ ê²€ìƒ‰ ì ìš©
                
                if (query.length >= 2) {
                    showVehicleSearchSuggestions(query);
                } else {
                    hideSuggestions();
                }
            });

            searchInput.addEventListener('focus', function() {
                if (this.value.length >= 2) {
                    showVehicleSearchSuggestions(this.value);
                }
            });

            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !suggestions.contains(e.target)) {
                    hideSuggestions();
                }
            });
        }

        // ì°¨ëŸ‰ ê²€ìƒ‰ ì œì•ˆ í‘œì‹œ
        function showVehicleSearchSuggestions(query) {
            const suggestions = document.getElementById('vehicleSearchSuggestions');
            if (!suggestions) return;

            const manufacturers = [...new Set(nationalSubsidyData.map(v => v.manufacturer))];
            const models = [...new Set(nationalSubsidyData.map(v => v.model))];
            
            const filteredSuggestions = [
                ...manufacturers.filter(m => m.toLowerCase().includes(query.toLowerCase())),
                ...models.filter(m => m.toLowerCase().includes(query.toLowerCase()))
            ].slice(0, 8);

            if (filteredSuggestions.length > 0) {
                suggestions.innerHTML = filteredSuggestions.map(suggestion => {
                    const highlighted = highlightSearchTerm(suggestion, query);
                    return `<div class="suggestion-item" onclick="selectSearchSuggestion('${suggestion.replace(/'/g, "\\'")}')">${highlighted}</div>`;
                }).join('');
                suggestions.style.display = 'block';
            } else {
                suggestions.style.display = 'none';
            }
        }

        // ê²€ìƒ‰ ì œì•ˆ ì„ íƒ
        function selectSearchSuggestion(suggestion) {
            document.getElementById('vehicleSearch').value = suggestion;
            filterByManufacturer(); // ì œì¡°ì‚¬ í•„í„°ì™€ í•¨ê»˜ ê²€ìƒ‰ ì ìš©
            hideSuggestions();
        }

        // ê²€ìƒ‰ ì œì•ˆ ìˆ¨ê¸°ê¸°
        function hideSuggestions() {
            const suggestions = document.getElementById('vehicleSearchSuggestions');
            if (suggestions) {
                suggestions.style.display = 'none';
            }
        }

        // ì œì¡°ì‚¬ë³„ í•„í„°ë§
        function filterByManufacturer() {
            const selectedManufacturer = document.getElementById('manufacturerFilter').value;
            
            let filtered = nationalSubsidyData;
            
            // ì œì¡°ì‚¬ í•„í„° ì ìš©
            if (selectedManufacturer) {
                filtered = filtered.filter(vehicle => vehicle.manufacturer === selectedManufacturer);
            }
            
            filteredVehicles = filtered;
            populateVehicleList(filteredVehicles);
            updateVehicleCount(filteredVehicles.length);
        }

        // ì œì¡°ì‚¬ ì˜µì…˜ ìƒì„±
        function populateManufacturerOptions() {
            const select = document.getElementById('manufacturerFilter');
            if (!select) return;
            
            // ìš°ì„ ìˆœìœ„ ì œì¡°ì‚¬ ìˆœì„œ ì •ì˜
            const priorityManufacturers = [
                'í˜„ëŒ€ìë™ì°¨',
                'ê¸°ì•„', 
                'ë©”ë¥´ì„¸ë°ìŠ¤-ë²¤ì¸ ',
                'BMW',
                'í…ŒìŠ¬ë¼'
            ];
            
            // ì „ì²´ ì œì¡°ì‚¬ ëª©ë¡ì—ì„œ ìš°ì„ ìˆœìœ„ ì œì¡°ì‚¬ ì œì™¸
            const allManufacturers = [...new Set(nationalSubsidyData.map(vehicle => vehicle.manufacturer))];
            const otherManufacturers = allManufacturers.filter(m => !priorityManufacturers.includes(m));
            
            // ë‚˜ë¨¸ì§€ ì œì¡°ì‚¬ë“¤ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬
            otherManufacturers.sort();
            
            // ìµœì¢… ìˆœì„œ: ìš°ì„ ìˆœìœ„ ì œì¡°ì‚¬ + ë‚˜ë¨¸ì§€ ì œì¡°ì‚¬
            const orderedManufacturers = [...priorityManufacturers, ...otherManufacturers];
            
            orderedManufacturers.forEach(manufacturer => {
                // í•´ë‹¹ ì œì¡°ì‚¬ì˜ ì°¨ëŸ‰ì´ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                const hasVehicles = nationalSubsidyData.some(vehicle => vehicle.manufacturer === manufacturer);
                if (hasVehicles) {
                    const option = document.createElement('option');
                    option.value = manufacturer;
                    option.textContent = manufacturer;
                    select.appendChild(option);
                }
            });
        }

        // ì°¨ëŸ‰ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateVehicleCount(count) {
            const countElement = document.getElementById('vehicleCount');
            if (countElement) {
                countElement.textContent = `ì´ ${count}ê°œ ì°¨ëŸ‰`;
            }
        }

        // ì§ì ‘ ì…ë ¥ ê²€ìƒ‰ ê¸°ëŠ¥ ì„¤ì •
        function setupCustomVehicleSearch() {
            const customInput = document.getElementById('customVehicleName');
            const customSuggestions = document.getElementById('customVehicleSuggestions');

            if (!customInput || !customSuggestions) return;

            customInput.addEventListener('input', function() {
                const query = this.value.trim();
                if (query.length >= 2) {
                    showCustomVehicleSuggestions(query);
                } else {
                    hideCustomSuggestions();
                }
            });

            customInput.addEventListener('focus', function() {
                if (this.value.length >= 2) {
                    showCustomVehicleSuggestions(this.value);
                }
            });

            document.addEventListener('click', function(e) {
                if (!customInput.contains(e.target) && !customSuggestions.contains(e.target)) {
                    hideCustomSuggestions();
                }
            });
        }

        // ì§ì ‘ ì…ë ¥ìš© ì°¨ëŸ‰ ì œì•ˆ í‘œì‹œ
        function showCustomVehicleSuggestions(query) {
            const suggestions = document.getElementById('customVehicleSuggestions');
            if (!suggestions) return;

            const filtered = nationalSubsidyData.filter(vehicle => 
                vehicle.model.toLowerCase().includes(query.toLowerCase()) ||
                vehicle.manufacturer.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 10);

            if (filtered.length > 0) {
                suggestions.innerHTML = filtered.map(vehicle => {
                    const displayText = `${vehicle.manufacturer} ${vehicle.model}`;
                    const highlightedText = highlightSearchTerm(displayText, query);
                    
                    return `<div class="suggestion-item" onclick="selectFromCustomSuggestion('${vehicle.manufacturer.replace(/'/g, "\\'")}', '${vehicle.model.replace(/'/g, "\\'")}', ${vehicle.subsidy})">
                        ${highlightedText}
                        <div style="font-size: 0.8rem; color: #64748b; margin-top: 2px;">êµ­ê³ ë³´ì¡°ê¸ˆ: ${vehicle.subsidy}ë§Œì›</div>
                    </div>`;
                }).join('');
                suggestions.style.display = 'block';
            } else {
                suggestions.innerHTML = '<div class="suggestion-item">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                suggestions.style.display = 'block';
            }
        }

        // ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸ ê¸°ëŠ¥
        function highlightSearchTerm(text, term) {
            const regex = new RegExp(`(${term})`, 'gi');
            return text.replace(regex, '<span class="suggestion-highlight">$1</span>');
        }

        // ì§ì ‘ ì…ë ¥ ì œì•ˆì—ì„œ ì„ íƒ
        function selectFromCustomSuggestion(manufacturer, model, subsidy) {
            selectedVehicle = { manufacturer, model, subsidy };
            document.getElementById('customVehicleName').value = `${manufacturer} ${model}`;
            showSelectedVehicleInfo(`${manufacturer} ${model}`, subsidy);
            hideCustomSuggestions();
        }

        // ì§ì ‘ ì…ë ¥ ì œì•ˆ ìˆ¨ê¸°ê¸°
        function hideCustomSuggestions() {
            const suggestions = document.getElementById('customVehicleSuggestions');
            if (suggestions) {
                suggestions.style.display = 'none';
            }
        }

        // ì°¨ëŸ‰ íƒ­ ì „í™˜
        function switchVehicleTab(tab) {
            currentTab = tab;
            
            // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.vehicle-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchVehicleTab('${tab}')"]`).classList.add('active');
            
            // íƒ­ íŒ¨ë„ í‘œì‹œ/ìˆ¨ê¹€
            document.querySelectorAll('.vehicle-tab-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            
            // ì°¨ëŸ‰ ëª©ë¡ íƒ­ ì„ íƒ ì‹œ ëª©ë¡ì´ ë¹„ì–´ìˆìœ¼ë©´ ë‹¤ì‹œ ìƒì„±
            if (tab === 'list') {
                const vehicleList = document.getElementById('vehicleList');
                if (!vehicleList.innerHTML.trim()) {
                    populateVehicleList();
                }
            }
        }

        // ì°¨ëŸ‰ ì„ íƒ ì´ˆê¸°í™”
        function clearVehicleSelection() {
            selectedVehicle = null;
            document.getElementById('selectedVehicleInfo').style.display = 'none';
            
            // ëª©ë¡ì—ì„œ ì„ íƒëœ í•­ëª© í•´ì œ
            document.querySelectorAll('.vehicle-item').forEach(item => item.classList.remove('selected'));
        }

        // ì§ì ‘ ì…ë ¥ ì„ íƒ ì´ˆê¸°í™”
        function clearCustomSelection() {
            document.getElementById('customVehicleName').value = '';
            document.getElementById('customSubsidy').value = '';
            clearVehicleSelection();
            hideCustomSuggestions();
        }

        // ì „ì²´ ë°ì´í„° ë¡œë“œ (êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„° ê¸°ë°˜)
        function loadCompleteData() {
            console.log('ì™„ì „í•œ ë°ì´í„° ë¡œë“œ ì¤‘...');
            nationalSubsidyData = [
                // í˜„ëŒ€ìë™ì°¨ - ì œë„¤ì‹œìŠ¤
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ 2WD 19ì¸ì¹˜', subsidy: 287 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ AWD 19ì¸ì¹˜', subsidy: 261 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ AWD 20ì¸ì¹˜', subsidy: 251 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 í¼í¬ë¨¼ìŠ¤ AWD 21ì¸ì¹˜', subsidy: 236 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'Electrified GV70 AWD 20ì¸ì¹˜', subsidy: 244 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'Electrified GV70 AWD 19ì¸ì¹˜', subsidy: 260 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'Electrified G80 AWD 19ì¸ì¹˜(2025)', subsidy: 275 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'Electrified GV70 AWD 20ì¸ì¹˜(2025)', subsidy: 250 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'Electrified GV70 AWD 19ì¸ì¹˜(2025)', subsidy: 266 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 í¼í¬ë¨¼ìŠ¤ AWD 21ì¸ì¹˜(2025)', subsidy: 248 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ AWD 20ì¸ì¹˜(2025)', subsidy: 266 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ AWD 19ì¸ì¹˜(2025)', subsidy: 277 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'GV60 ìŠ¤íƒ ë‹¤ë“œ 2WD 19ì¸ì¹˜(2025)', subsidy: 290 },

                // í˜„ëŒ€ìë™ì°¨ - ì•„ì´ì˜¤ë‹‰
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰6 ìŠ¤íƒ ë‹¤ë“œ 2WD 18ì¸ì¹˜', subsidy: 635 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰6 ë¡±ë ˆì¸ì§€ 2WD 18ì¸ì¹˜', subsidy: 686 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰6 ë¡±ë ˆì¸ì§€ 2WD 20ì¸ì¹˜', subsidy: 680 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰6 ë¡±ë ˆì¸ì§€ AWD 18ì¸ì¹˜', subsidy: 686 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰6 ë¡±ë ˆì¸ì§€ AWD 20ì¸ì¹˜', subsidy: 647 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰5 N', subsidy: 232 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 2WD ë¡±ë ˆì¸ì§€ 19ì¸ì¹˜ ë¹ŒíŠ¸ì¸ ìº  ë¯¸ì ìš©', subsidy: 659 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 2WD ë¡±ë ˆì¸ì§€ 19ì¸ì¹˜', subsidy: 656 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 2WD ë¡±ë ˆì¸ì§€ 20ì¸ì¹˜', subsidy: 651 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 AWD ë¡±ë ˆì¸ì§€ 20ì¸ì¹˜', subsidy: 624 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 AWD ë¡±ë ˆì¸ì§€ 19ì¸ì¹˜', subsidy: 650 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 AWD ë¡±ë ˆì¸ì§€ Në¼ì¸ 20ì¸ì¹˜', subsidy: 602 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 2WD ë¡±ë ˆì¸ì§€ Në¼ì¸ 20ì¸ì¹˜', subsidy: 633 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ë”ë‰´ì•„ì´ì˜¤ë‹‰5 2WD ìŠ¤íƒ ë‹¤ë“œ 19ì¸ì¹˜', subsidy: 561 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰9 ì„±ëŠ¥í˜• AWD', subsidy: 277 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰9 í•­ì†í˜• 2WD', subsidy: 279 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì•„ì´ì˜¤ë‹‰9 í•­ì†í˜• AWD', subsidy: 276 },

                // í˜„ëŒ€ìë™ì°¨ - ì½”ë‚˜
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì½”ë‚˜ ì¼ë ‰íŠ¸ë¦­ 2WD ìŠ¤íƒ ë‹¤ë“œ 17ì¸ì¹˜', subsidy: 573 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì½”ë‚˜ ì¼ë ‰íŠ¸ë¦­ 2WD ë¡±ë ˆì¸ì§€ 17ì¸ì¹˜', subsidy: 623 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì½”ë‚˜ ì¼ë ‰íŠ¸ë¦­ 2WD ë¡±ë ˆì¸ì§€ 19ì¸ì¹˜(ë¹ŒíŠ¸ì¸ ìº )', subsidy: 568 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ì½”ë‚˜ ì¼ë ‰íŠ¸ë¦­ 2WD ë¡±ë ˆì¸ì§€ 17ì¸ì¹˜(ë¹ŒíŠ¸ì¸ ìº )', subsidy: 623 },

                // í˜„ëŒ€ìë™ì°¨ - ìºìŠ¤í¼
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ìºìŠ¤í¼ ì¼ë ‰íŠ¸ë¦­ í•­ì†í˜• 17ì¸ì¹˜', subsidy: 500 },
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ìºìŠ¤í¼ ì¼ë ‰íŠ¸ë¦­ í•­ì†í˜• 15ì¸ì¹˜', subsidy: 500 },
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ìºìŠ¤í¼ ì¼ë ‰íŠ¸ë¦­ ê¸°ë³¸í˜• 15ì¸ì¹˜', subsidy: 500 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í˜„ëŒ€ìë™ì°¨', model: 'ìºìŠ¤í¼ ì¼ë ‰íŠ¸ë¦­ í¬ë¡œìŠ¤ 17ì¸ì¹˜', subsidy: 500 },

                // ê¸°ì•„ - EV9
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ë¡±ë ˆì¸ì§€ 2WD 19ì¸ì¹˜', subsidy: 275 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ë¡±ë ˆì¸ì§€ 2WD 20ì¸ì¹˜', subsidy: 273 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ë¡±ë ˆì¸ì§€ 4WD 19ì¸ì¹˜', subsidy: 259 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ë¡±ë ˆì¸ì§€ 4WD 21ì¸ì¹˜', subsidy: 265 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ë¡±ë ˆì¸ì§€ GTL 4WD 21ì¸ì¹˜', subsidy: 257 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV9 ìŠ¤íƒ ë‹¤ë“œ', subsidy: 242 },

                // ê¸°ì•„ - EV6
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 ë¡±ë ˆì¸ì§€ 4WD 20ì¸ì¹˜', subsidy: 617 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 ë¡±ë ˆì¸ì§€ 2WD 20ì¸ì¹˜', subsidy: 644 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 ë¡±ë ˆì¸ì§€ 4WD 19ì¸ì¹˜', subsidy: 646 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 ë¡±ë ˆì¸ì§€ 2WD 19ì¸ì¹˜', subsidy: 655 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 GT', subsidy: 232 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'ë”ë‰´EV6 ìŠ¤íƒ ë‹¤ë“œ', subsidy: 582 },

                // ê¸°ì•„ - EV3
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV3 ìŠ¤íƒ ë‹¤ë“œ 2WD', subsidy: 479 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV3 ë¡±ë ˆì¸ì§€ 2WD 17ì¸ì¹˜', subsidy: 565 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV3 ë¡±ë ˆì¸ì§€ 2WD 19ì¸ì¹˜', subsidy: 565 },

                // ê¸°ì•„ - EV4
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV4 ë¡±ë ˆì¸ì§€ GTL 2WD 19ì¸ì¹˜', subsidy: 565 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV4 ìŠ¤íƒ ë‹¤ë“œ 2WD 19ì¸ì¹˜', subsidy: 491 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV4 ë¡±ë ˆì¸ì§€ 2WD 17ì¸ì¹˜', subsidy: 565 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV4 ë¡±ë ˆì¸ì§€ 2WD 19ì¸ì¹˜', subsidy: 565 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'EV4 ìŠ¤íƒ ë‹¤ë“œ 2WD 17ì¸ì¹˜', subsidy: 522 },

                // ê¸°ì•„ - ë‹ˆë¡œ/ë ˆì´
                { type: 'ìŠ¹ìš©', manufacturer: 'ê¸°ì•„', model: 'The all-new Kia Niro EV', subsidy: 590 },
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'ê¸°ì•„', model: 'ë ˆì´ EV 2WD 14ì¸ì¹˜ 4ì¸ìŠ¹ ìŠ¹ìš©', subsidy: 457 },
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'ê¸°ì•„', model: 'ë ˆì´ EV 2WD 14ì¸ì¹˜ 2ì¸ìŠ¹ ë°´', subsidy: 457 },
                { type: 'ê²½Â·ì†Œí˜•', manufacturer: 'ê¸°ì•„', model: 'ë ˆì´ EV 2WD 14ì¸ì¹˜ 1ì¸ìŠ¹ ë°´', subsidy: 457 },

                // BMW
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'i4 eDrive40', subsidy: 189 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'i4 M50', subsidy: 172 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'iX1 xDrive30', subsidy: 154 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'i4 eDrive40 LCI', subsidy: 187 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI Aceman SE', subsidy: 306 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI Countryman E', subsidy: 166 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI Countryman SE ALL4', subsidy: 158 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'iX2 eDrive20', subsidy: 167 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'i4 M50 LCI', subsidy: 177 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI JCW Aceman E', subsidy: 151 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI JCW E', subsidy: 147 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI Aceman E', subsidy: 306 },
                { type: 'ìŠ¹ìš©', manufacturer: 'BMW', model: 'MINI Cooper SE', subsidy: 303 },

                // í…ŒìŠ¬ë¼
                { type: 'ìŠ¹ìš©', manufacturer: 'í…ŒìŠ¬ë¼', model: 'Model 3 Long Range', subsidy: 202 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í…ŒìŠ¬ë¼', model: 'Model 3 Performance', subsidy: 187 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í…ŒìŠ¬ë¼', model: 'Model 3 RWD', subsidy: 186 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í…ŒìŠ¬ë¼', model: 'New Model Y Long Range', subsidy: 207 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í…ŒìŠ¬ë¼', model: 'New Model Y RWD', subsidy: 188 },

                // ë©”ë¥´ì„¸ë°ìŠ¤ ë²¤ì¸ 
                { type: 'ìŠ¹ìš©', manufacturer: 'ë©”ë¥´ì„¸ë°ìŠ¤-ë²¤ì¸ ', model: 'EQA250(Facelift)', subsidy: 190 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ë©”ë¥´ì„¸ë°ìŠ¤-ë²¤ì¸ ', model: 'EQB300 4MATIC(Facelift)(5ì¸ìŠ¹)', subsidy: 154 },
                { type: 'ìŠ¹ìš©', manufacturer: 'ë©”ë¥´ì„¸ë°ìŠ¤-ë²¤ì¸ ', model: 'EQB300 4MATIC(Facelift)(7ì¸ìŠ¹)', subsidy: 154 },

                // KGëª¨ë¹Œë¦¬í‹°
                { type: 'ìŠ¹ìš©', manufacturer: 'KGëª¨ë¹Œë¦¬í‹°', model: 'í† ë ˆìŠ¤ EVX 2WD 18ì¸ì¹˜', subsidy: 373 },
                { type: 'ìŠ¹ìš©', manufacturer: 'KGëª¨ë¹Œë¦¬í‹°', model: 'í† ë ˆìŠ¤ EVX 2WD 20ì¸ì¹˜', subsidy: 356 },
                { type: 'ìŠ¹ìš©', manufacturer: 'KGëª¨ë¹Œë¦¬í‹°', model: 'ì½”ë€ë„ EV 2WD', subsidy: 340 },
                { type: 'ìŠ¹ìš©', manufacturer: 'KGëª¨ë¹Œë¦¬í‹°', model: 'í† ë ˆìŠ¤ EVX 20ì¸ì¹˜', subsidy: 354 },
                { type: 'ìŠ¹ìš©', manufacturer: 'KGëª¨ë¹Œë¦¬í‹°', model: 'í† ë ˆìŠ¤ EVX 18ì¸ì¹˜', subsidy: 364 },

                // í´ìŠ¤íƒ€
                { type: 'ìŠ¹ìš©', manufacturer: 'í´ìŠ¤íƒ€', model: 'Polestar 4 Long Range Single Motor', subsidy: 181 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í´ìŠ¤íƒ€', model: 'Polestar 4 Long Range Dual Motor', subsidy: 141 },

                // ë³¼ë³´
                { type: 'ìŠ¹ìš©', manufacturer: 'ë³¼ë³´', model: 'ë³¼ë³´ EX30 Single Motor ER', subsidy: 247 },

                // í­ìŠ¤ë°”ê²/ì•„ìš°ë””
                { type: 'ìŠ¹ìš©', manufacturer: 'í­ìŠ¤ë°”ê²', model: 'ì•„ìš°ë”” Q4 Sportback 45 e-tron', subsidy: 201 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í­ìŠ¤ë°”ê²', model: 'ì•„ìš°ë”” Q4 45 e-tron', subsidy: 201 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í­ìŠ¤ë°”ê²', model: 'í­ìŠ¤ë°”ê² ID.4 Pro', subsidy: 422 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í­ìŠ¤ë°”ê²', model: 'ì•„ìš°ë”” Q6 e-tron performance', subsidy: 220 },
                { type: 'ìŠ¹ìš©', manufacturer: 'í­ìŠ¤ë°”ê²', model: 'BYD ATTO 3', subsidy: 145 }
            ];

            localSubsidyData = [
                { region: 'ì„œìš¸íŠ¹ë³„ì‹œ', subsidy: 400 },
                { region: 'ë¶€ì‚°ê´‘ì—­ì‹œ', subsidy: 300 },
                { region: 'ëŒ€êµ¬ê´‘ì—­ì‹œ', subsidy: 250 },
                { region: 'ì¸ì²œê´‘ì—­ì‹œ', subsidy: 350 },
                { region: 'ê´‘ì£¼ê´‘ì—­ì‹œ', subsidy: 200 },
                { region: 'ëŒ€ì „ê´‘ì—­ì‹œ', subsidy: 300 },
                { region: 'ìš¸ì‚°ê´‘ì—­ì‹œ', subsidy: 400 },
                { region: 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ', subsidy: 500 },
                { region: 'ê²½ê¸°ë„', subsidy: 300 },
                { region: 'ê°•ì›ë„', subsidy: 400 },
                { region: 'ì¶©ì²­ë¶ë„', subsidy: 350 },
                { region: 'ì¶©ì²­ë‚¨ë„', subsidy: 300 },
                { region: 'ì „ë¼ë¶ë„', subsidy: 400 },
                { region: 'ì „ë¼ë‚¨ë„', subsidy: 450 },
                { region: 'ê²½ìƒë¶ë„', subsidy: 300 },
                { region: 'ê²½ìƒë‚¨ë„', subsidy: 350 },
                { region: 'ì œì£¼íŠ¹ë³„ìì¹˜ë„', subsidy: 600 }
            ];
            
            filteredVehicles = nationalSubsidyData;
            console.log(`ì™„ì „í•œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ: êµ­ê³ ë³´ì¡°ê¸ˆ ${nationalSubsidyData.length}ê°œ, ì§€ìì²´ë³´ì¡°ê¸ˆ ${localSubsidyData.length}ê°œ`);
        }

        // ì°¨ëŸ‰ ëª©ë¡ ìƒì„±
        function populateVehicleList(vehicles = null) {
            const vehicleList = document.getElementById('vehicleList');
            if (!vehicleList) {
                console.error('vehicleList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const displayVehicles = vehicles || filteredVehicles;
            vehicleList.innerHTML = '';
            
            if (displayVehicles.length === 0) {
                vehicleList.innerHTML = '<div class="vehicle-item">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                updateVehicleCount(0);
                return;
            }
            
            // ì„ íƒ ì•ˆí•¨ ì˜µì…˜ ì¶”ê°€
            const noSelectionItem = document.createElement('div');
            noSelectionItem.className = 'vehicle-item no-selection';
            noSelectionItem.onclick = () => selectVehicleFromList(null, noSelectionItem);
            noSelectionItem.innerHTML = `
                <div class="vehicle-name">ì„ íƒ ì•ˆí•¨</div>
                <div class="vehicle-subsidy subsidy-none">êµ­ê³  ë³´ì¡°ê¸ˆ: 0ë§Œì›</div>
            `;
            vehicleList.appendChild(noSelectionItem);
            
            displayVehicles.forEach((vehicle, index) => {
                const vehicleItem = document.createElement('div');
                vehicleItem.className = 'vehicle-item';
                vehicleItem.onclick = () => selectVehicleFromList(vehicle, vehicleItem);
                
                // ë³´ì¡°ê¸ˆ ê¸ˆì•¡ì— ë”°ë¥¸ ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì •
                let subsidyClass = 'subsidy-high'; // ê¸°ë³¸ ë†’ì€ ë³´ì¡°ê¸ˆ
                if (vehicle.subsidy < 300) {
                    subsidyClass = 'subsidy-low'; // ë‚®ì€ ë³´ì¡°ê¸ˆ (300ë§Œì› ë¯¸ë§Œ)
                } else if (vehicle.subsidy < 500) {
                    subsidyClass = 'subsidy-medium'; // ì¤‘ê°„ ë³´ì¡°ê¸ˆ (300-500ë§Œì›)
                }
                
                vehicleItem.innerHTML = `
                    <div class="vehicle-name">${vehicle.manufacturer} ${vehicle.model}</div>
                    <div class="vehicle-subsidy ${subsidyClass}">êµ­ê³  ë³´ì¡°ê¸ˆ: ${vehicle.subsidy}ë§Œì›</div>
                `;
                
                vehicleList.appendChild(vehicleItem);
            });
            
            updateVehicleCount(displayVehicles.length);
            console.log(`ì°¨ëŸ‰ ëª©ë¡ ìƒì„± ì™„ë£Œ: ${displayVehicles.length}ê°œ ì°¨ëŸ‰`);
        }

        // ëª©ë¡ì—ì„œ ì°¨ëŸ‰ ì„ íƒ
        function selectVehicleFromList(vehicle, element) {
            // ì´ì „ ì„ íƒ í•´ì œ
            document.querySelectorAll('.vehicle-item').forEach(item => item.classList.remove('selected'));
            
            // í˜„ì¬ ì„ íƒ í‘œì‹œ
            element.classList.add('selected');
            
            // ì°¨ëŸ‰ ì •ë³´ ì €ì¥
            selectedVehicle = vehicle;
            
            // ì„ íƒëœ ì°¨ëŸ‰ ì •ë³´ í‘œì‹œ
            if (vehicle) {
                showSelectedVehicleInfo(`${vehicle.manufacturer} ${vehicle.model}`, vehicle.subsidy);
            } else {
                // ì„ íƒ ì•ˆí•¨ì˜ ê²½ìš°
                showSelectedVehicleInfo('ì„ íƒ ì•ˆí•¨', 0);
            }
        }

        // ì§ì ‘ ì…ë ¥ ì°¨ëŸ‰ ì„ íƒ
        function selectCustomVehicle() {
            const customName = document.getElementById('customVehicleName').value.trim();
            const customSubsidyInput = document.getElementById('customSubsidy').value;
            
            if (!customName && !customSubsidyInput) {
                showError('ì°¨ëŸ‰ ëª¨ë¸ëª… ë˜ëŠ” ë³´ì¡°ê¸ˆì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            let finalSubsidy = 680; // ê¸°ë³¸ê°’
            
            // ì§ì ‘ ì…ë ¥ëœ ë³´ì¡°ê¸ˆì´ ìˆìœ¼ë©´ ìš°ì„  ì ìš©
            if (customSubsidyInput) {
                finalSubsidy = parseInt(customSubsidyInput);
            } else {
                // ì…ë ¥ëœ ì´ë¦„ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ì°¨ëŸ‰ ì°¾ê¸°
                const exactMatch = nationalSubsidyData.find(vehicle => 
                    `${vehicle.manufacturer} ${vehicle.model}`.toLowerCase() === customName.toLowerCase()
                );
                
                if (exactMatch) {
                    finalSubsidy = exactMatch.subsidy;
                }
            }
            
            selectedVehicle = {
                manufacturer: 'ì‚¬ìš©ì ì…ë ¥',
                model: customName || 'ì§ì ‘ ì…ë ¥',
                subsidy: finalSubsidy,
                type: 'ìŠ¹ìš©'
            };
            
            showSelectedVehicleInfo(customName || 'ì§ì ‘ ì…ë ¥', finalSubsidy);
            hideCustomSuggestions();
        }

        // ì·¨ë“ì„¸ ê³„ì‚°
        function calculateTax() {
            console.log('ê³„ì‚° ì‹œì‘...');
            
            // ì…ë ¥ê°’ ê²€ì¦
            const vehiclePrice = parseInt(document.getElementById('vehiclePrice').value) || 0;
            const vehicleType = document.getElementById('vehicleType').value;
            const localSubsidyAmount = parseInt(document.getElementById('localSubsidy').value) || 0;

            console.log('ì…ë ¥ê°’:', { vehiclePrice, vehicleType, localSubsidyAmount });

            if (!vehiclePrice) {
                showError('ì°¨ëŸ‰ ê°€ì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!vehicleType) {
                showError('ì°¨ëŸ‰ ì¢…ë¥˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„¸ìœ¨ ì„¤ì •
            const taxRates = {
                'passenger': 0.07,
                'van': 0.05,
                'truck': 0.05,
                'commercial': 0.04
            };

            // ë³´ì¡°ê¸ˆ ê³„ì‚°
            let nationalSubsidy = 0;
            if (selectedVehicle) {
                nationalSubsidy = selectedVehicle.subsidy;
            }

            console.log('ì„ íƒëœ ì°¨ëŸ‰:', selectedVehicle);
            console.log('êµ­ê³ ë³´ì¡°ê¸ˆ:', nationalSubsidy);

            // ë³´ì¡°ê¸ˆ ì§€ì› ê¸°ì¤€ ì ìš©
            let subsidyRate = 1;
            if (vehiclePrice >= 8500) {
                subsidyRate = 0;
            } else if (vehiclePrice >= 5300) {
                subsidyRate = 0.5;
            }

            const finalNationalSubsidy = Math.floor(nationalSubsidy * subsidyRate);
            const finalLocalSubsidy = Math.floor(localSubsidyAmount * subsidyRate);
            const totalSubsidy = finalNationalSubsidy + finalLocalSubsidy;

            // ê¸°ë³¸ ì·¨ë“ì„¸ ê³„ì‚°
            const taxRate = taxRates[vehicleType];
            const baseTax = Math.floor(vehiclePrice * taxRate);

            // ê°ë©´ ê³„ì‚°
            let taxReduction = 0;
            const currentYear = new Date().getFullYear();
            
            if (selectedVehicle && (selectedVehicle.model.includes('ë ˆì´') || selectedVehicle.model.includes('ìºìŠ¤í¼') || selectedVehicle.type === 'ê²½Â·ì†Œí˜•')) {
                const miniCarTax = Math.floor(vehiclePrice * 0.04);
                taxReduction = Math.min(75, miniCarTax);
            } else {
                if (currentYear <= 2026) {
                    taxReduction = Math.min(140, baseTax);
                } else if (currentYear === 2027) {
                    taxReduction = Math.min(100, baseTax);
                }
            }

            // ìµœì¢… ì·¨ë“ì„¸ ê³„ì‚°
            const finalTax = Math.max(0, baseTax - taxReduction);

            // ì´ ì°¨ëŸ‰ ì§€ë¶ˆ ê¸ˆì•¡ ê³„ì‚° (ì°¨ëŸ‰ ê°€ê²© + ìµœì¢… ì·¨ë“ì„¸ - ì´ ë³´ì¡°ê¸ˆ)
            const totalPayment = vehiclePrice + finalTax - totalSubsidy;

            console.log('ê³„ì‚° ê²°ê³¼:', {
                finalNationalSubsidy,
                finalLocalSubsidy,
                totalSubsidy,
                baseTax,
                taxReduction,
                finalTax,
                totalPayment
            });

            // ê²°ê³¼ í‘œì‹œ
            displayResults({
                nationalSubsidy: finalNationalSubsidy,
                localSubsidy: finalLocalSubsidy,
                totalSubsidy: totalSubsidy,
                baseTax: baseTax,
                taxReduction: taxReduction,
                finalTax: finalTax,
                totalPayment: totalPayment
            });

            console.log('ê²°ê³¼ í‘œì‹œ ì™„ë£Œ');
            
            const resultSection = document.getElementById('resultSection');
            if (resultSection) {
                resultSection.style.display = 'block';
                resultSection.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
                console.log('ê²°ê³¼ ì„¹ì…˜ í‘œì‹œë¨');
            } else {
                console.error('ê²°ê³¼ ì„¹ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
        }

        // ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ ëª¨ë‹¬
        function showPrivacyPolicy() {
            alert('ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨\n\në³¸ ê³„ì‚°ê¸°ëŠ” ì‚¬ìš©ìì˜ ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nì…ë ¥ëœ ì°¨ëŸ‰ ì •ë³´ì™€ ê³„ì‚° ê²°ê³¼ëŠ” ë¡œì»¬ì—ì„œë§Œ ì²˜ë¦¬ë˜ë©° ì„œë²„ì— ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\në¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ contact@ev-calculator.comìœ¼ë¡œ ì—°ë½ì£¼ì„¸ìš”.');
        }

        // ì´ìš©ì•½ê´€ ëª¨ë‹¬  
        function showTerms() {
            alert('ì´ìš©ì•½ê´€\n\n1. ë³¸ ê³„ì‚°ê¸°ëŠ” ì°¸ê³ ìš©ìœ¼ë¡œ ì œê³µë˜ë©°, ì‹¤ì œ ì„¸ì•¡ê³¼ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n2. ì •í™•í•œ ì„¸ì•¡ì€ ê´€í•  ì„¸ë¬´ì„œë‚˜ ì „ë¬¸ê¸°ê´€ì— ë¬¸ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\n3. ë³´ì¡°ê¸ˆ ì •ë³´ëŠ” ìˆ˜ì‹œë¡œ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ êµ¬ë§¤ ì „ ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”.\n4. ë³¸ ì„œë¹„ìŠ¤ ì´ìš©ìœ¼ë¡œ ì¸í•œ ì†í•´ì— ëŒ€í•´ ì±…ì„ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nì„œë¹„ìŠ¤ ì´ìš© ì‹œ ìœ„ ì•½ê´€ì— ë™ì˜í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.');
        }

        // ì„ íƒëœ ì°¨ëŸ‰ ì •ë³´ í‘œì‹œ
        function showSelectedVehicleInfo(name, subsidy) {
            document.getElementById('selectedVehicleName').textContent = name;
            document.getElementById('selectedVehicleSubsidy').textContent = subsidy;
            document.getElementById('selectedVehicleInfo').style.display = 'block';
        }

        // ì§€ìì²´ ë³´ì¡°ê¸ˆ ì˜µì…˜ ìƒì„±
        function populateLocalSubsidyOptions() {
            const select = document.getElementById('localSubsidy');
            // ê¸°ë³¸ ì˜µì…˜ë“¤ ìœ ì§€í•˜ê³  ì§€ì—­ ì˜µì…˜ë“¤ë§Œ ì¶”ê°€
            const existingOptions = select.innerHTML;
            
            localSubsidyData.forEach(item => {
                const option = document.createElement('option');
                option.value = item.subsidy;
                option.textContent = `${item.region} (${item.subsidy}ë§Œì›)`;
                select.appendChild(option);
            });
        }

        // ê°€ê²© ì¡°ì‘ í•¨ìˆ˜ë“¤
        function addPrice(amount) {
            const priceInput = document.getElementById('vehiclePrice');
            const currentValue = parseInt(priceInput.value) || 0;
            priceInput.value = currentValue + amount;
        }

        function clearPrice() {
            document.getElementById('vehiclePrice').value = '';
        }

        // ê²°ê³¼ í‘œì‹œ
        function displayResults(results) {
            console.log('ê²°ê³¼ í‘œì‹œ ì‹œì‘:', results);
            
            // ê¸°ë³¸ ê²°ê³¼ í‘œì‹œ
            document.getElementById('nationalSubsidy').innerHTML = `<span class="result-icon">ğŸ’°</span>${results.nationalSubsidy.toLocaleString()}ë§Œì›`;
            document.getElementById('localSubsidyAmount').innerHTML = `<span class="result-icon">ğŸ›ï¸</span>${results.localSubsidy.toLocaleString()}ë§Œì›`;
            document.getElementById('totalSubsidy').innerHTML = `<span class="result-icon">ğŸ’</span>${results.totalSubsidy.toLocaleString()}ë§Œì›`;
            document.getElementById('baseTax').innerHTML = `<span class="result-icon">ğŸ“‹</span>${results.baseTax.toLocaleString()}ë§Œì›`;
            document.getElementById('taxReduction').innerHTML = `<span class="result-icon">ğŸ</span>${results.taxReduction.toLocaleString()}ë§Œì›`;
            document.getElementById('finalTaxInGrid').innerHTML = `<span class="result-icon">ğŸ’¸</span>${results.finalTax.toLocaleString()}ë§Œì›`;
            
            // ê³„ì‚° ìš”ì•½ í‘œì‹œ
            const vehiclePrice = parseInt(document.getElementById('vehiclePrice').value) || 0;
            console.log('ì°¨ëŸ‰ ê°€ê²©:', vehiclePrice);
            
            const vehiclePriceEl = document.getElementById('vehiclePriceDisplay');
            const finalTaxEl = document.getElementById('finalTaxDisplay');
            const totalSubsidyEl = document.getElementById('totalSubsidyDisplay');
            const totalPaymentBreakdownEl = document.getElementById('totalPaymentBreakdown');
            
            if (vehiclePriceEl) {
                vehiclePriceEl.textContent = `${vehiclePrice.toLocaleString()}ë§Œì›`;
                console.log('ì°¨ëŸ‰ ê°€ê²© í‘œì‹œ ì™„ë£Œ');
            } else {
                console.error('vehiclePriceDisplay ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
            
            if (finalTaxEl) {
                finalTaxEl.textContent = `${results.finalTax.toLocaleString()}ë§Œì›`;
                console.log('ìµœì¢… ì·¨ë“ì„¸ í‘œì‹œ ì™„ë£Œ');
            } else {
                console.error('finalTaxDisplay ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
            
            if (totalSubsidyEl) {
                totalSubsidyEl.textContent = `${results.totalSubsidy.toLocaleString()}ë§Œì›`;
                console.log('ì´ ë³´ì¡°ê¸ˆ í‘œì‹œ ì™„ë£Œ');
            } else {
                console.error('totalSubsidyDisplay ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
            
            if (totalPaymentBreakdownEl) {
                totalPaymentBreakdownEl.textContent = `${results.totalPayment.toLocaleString()}ë§Œì›`;
                console.log('ì‹¤ì œ ì§€ë¶ˆ ê¸ˆì•¡ í‘œì‹œ ì™„ë£Œ');
            } else {
                console.error('totalPaymentBreakdown ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            }
            
            // ìµœì¢… ê²°ê³¼ í‘œì‹œ
            document.getElementById('totalPayment').innerHTML = `<span>ğŸ¦</span>${results.totalPayment.toLocaleString()}ë§Œì›`;
            
            console.log('ê²°ê³¼ í‘œì‹œ ì™„ë£Œ');
        }

        // ì—ëŸ¬ í‘œì‹œ
        function showError(message) {
            const existingError = document.querySelector('.error');
            if (existingError) {
                existingError.remove();
            }

            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            
            const calculateBtn = document.querySelector('.calculate-btn');
            calculateBtn.parentNode.insertBefore(errorDiv, calculateBtn);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }
    </script>
</body>
</html>